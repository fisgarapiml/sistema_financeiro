<!-- templates/dashboard_financeiro.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Dashboard ‚Äî Contas a Pagar</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --cor-principal: #00009f;
      --cor-fundo: #f4f6f8;
      --cor-texto: #333;
      --cor-sucesso: #27ae60;
      --cor-alerta: #f39c12;
      --cor-erro: #e74c3c;
    }

    body {
      background-color: var(--cor-fundo);
      font-family: 'Segoe UI', sans-serif;
      padding: 0;
      margin: 0;
    }

    .topbar {
      background-color: var(--cor-principal);
      padding: 1rem;
      color: white;
      text-align: center;
      font-size: 1.6rem;
      font-weight: 700;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .container-custom {
      max-width: 1240px;
      margin: 20px auto;
      padding: 0 20px;
    }

    .btn-filtro {
      background-color: var(--cor-principal);
      color: white;
      font-weight: bold;
      border: none;
      padding: 8px 20px;
      border-radius: 8px;
    }

    .card-indicador {
      background: white;
      border-left: 5px solid var(--cor-principal);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.08);
      text-align: center;
      font-size: 1.1rem;
    }

    .valor-indicador {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--cor-principal);
      margin-top: 8px;
    }

    canvas {
      max-width: 100%;
    }
  </style>
</head>
<body>

  <div class="topbar">
    üíº Dashboard ‚Äî Contas a Pagar
  </div>

  <div class="container-custom">
    <form method="get" class="mb-4 d-flex justify-content-start align-items-center gap-3">
      <input type="date" name="data_inicio" class="form-control w-auto" value="{{ data_inicio }}">
      <input type="date" name="data_fim" class="form-control w-auto" value="{{ data_fim }}">
      <button type="submit" class="btn-filtro">üóìÔ∏è Alterar Per√≠odo</button>
    </form>

    <div class="row g-3 mb-4">
      <div class="col-md-4">
        <div class="card-indicador">
          Previsto no Per√≠odo
          <div class="valor-indicador">R$ {{ total_previsto | round(2) | string | replace('.', ',') }}</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card-indicador">
          Pago no Per√≠odo
          <div class="valor-indicador">R$ {{ total_pago | round(2) | string | replace('.', ',') }}</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card-indicador">
          Saldo (Diferen√ßa)
          <div class="valor-indicador">R$ {{ saldo | round(2) | string | replace('.', ',') }}</div>
        </div>
      </div>
    </div>

    <div class="bg-white p-4 rounded shadow-sm mb-4">
      <h5 class="text-center mb-3">üìä Distribui√ß√£o por Status
      </h5>
      <canvas id="graficoStatus"></canvas>
    </div>

    <div class="bg-white p-4 rounded shadow-sm">
      <h5 class="text-center mb-3">üìÑ Distribui√ß√£o por Categoria
      </h5>
      <canvas id="graficoCategoria"></canvas>
    </div>
  </div>

  <script>
    const graficoStatus = document.getElementById("graficoStatus");
    new Chart(graficoStatus, {
      type: "bar",
      data: {
        labels: {{ labels_status | safe }},
        datasets: [{
          label: "Total (R$)",
          data: {{ valores_status | safe }},
          backgroundColor: '#f39c12'
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: true } }
      }
    });

    const graficoCategoria = document.getElementById("graficoCategoria");
    new Chart(graficoCategoria, {
      type: "doughnut",
      data: {
        labels: {{ labels_categoria | safe }},
        datasets: [{
          label: "Total (R$)",
          data: {{ valores_categoria | safe }},
          backgroundColor: ["#8e44ad", "#f39c12", "#27ae60", "#e74c3c", "#3498db", "#2c3e50"]
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: "bottom"
          }
        }
      }
    });
  </script>

</body>
</html>
